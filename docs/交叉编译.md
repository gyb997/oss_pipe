# 交叉编译

## macos 编译目标 linux

https://musl.libc.org/

wget https://musl.libc.org/releases/musl-1.2.5.tar.gz

```
cd musl-1.2.5/
./configure
make
make install
ln -s /usr/local/bin/x86_64-linux-musl-gcc /usr/local/bin/musl-gcc
```

~/.cargo/config
```
[target.x86_64-unknown-linux-musl]
linker = "x86_64-linux-musl-gcc"
```

## linux 编译目标 macos

https://github.com/cross-rs/cross-toolchains

```
git clone https://github.com/cross-rs/cross
cd cross
git submodule update --init --remote
```

```
# only configure the config file for a single target
$ cargo xtask configure-crosstool aarch64-apple-darwin
# configure all config files for crosstool images
$ cargo xtask configure-crosstool
```

打包 MacOS SDK
https://github.com/tpoechtrager/osxcross?tab=readme-ov-file#packaging-the-sdk




```
cargo build-docker-image aarch64-apple-darwin-cross --tag local

CROSS_CONTAINER_ENGINE_NO_BUILDKIT=1 cargo build-docker-image aarch64-apple-darwin-cross \
  --build-arg 'MACOS_SDK_DIR=/root/macos_sdk' \
  --build-arg 'MACOS_SDK_FILE=MacOSX15.2.sdk.tar.xz'

cargo build-docker-image aarch64-apple-darwin-cross \
  --build-arg 'MACOS_SDK_DIR=/root/macos_sdk' \
  --build-arg 'MACOS_SDK_FILE=/root/macos_sdk/MacOSX15.2.sdk.tar.xz' \
  --build-arg 'HTTP_PROXY=http://10.0.1.94:1083' \
  --build-arg 'HTTPS_PROXY=http://10.0.1.94:1083' 


```
